<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stream</title>
  <link rel="icon" type="image/x-icon"
    href="data:image/png;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAEAAAAAAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCAAUABADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD2v/gvR/wUN+LHw5+Odr8Hfhn4m1T4ZaTZ2NpPqPiG0T7Lda3qFzudLGG8ZlW3jji8pmZHVmknVWKoCTY/4IKf8FBPiv8AFT4y6l8H/iZ4j1H4mab/AGddXmn+JblftN1o17bvGZLCa8RnW4jkjaRldnZleB1DOhUr4h/wX4/ZKn+CH7dt18QNS1i3utD+MMjalYnU3WGz0l7eysrO6DSmZZDNBshuLcRDf+9KqkoSRTZ/4N+/2TZvjH+3FH8RtP1i1ttE+Dri7uhpjCey1mS6sL6yg2y+c0gmlEstzOJRvzEiskYZFH1XssP/AGdey2ve2t/XffQ+RVbEf2pytve1r6cvpttqfqX+3Z/wSq+Gv/BTOXwtN8SNQ8ZRxeDUuY9PttH1RbSDdceUZJHUxvufESKDngZHc5X9hb/glj8N/wDgmXF4qPw31DxlLb+Mvs32+11jVFu4Fe383ZJGojTa5ErKx5yAo/hFFFeO6s/qvJd27dN+x7nsYfW/acqv3trt3P/Z">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Verdana, Geneva, Tahoma, sans-serif;
      background-image: linear-gradient(45deg, rgb(255, 255, 255), #fff, #fff, rgb(141, 207, 158), rgb(123, 190, 192), rgb(130, 129, 180),
          rgb(160, 103, 132), rgb(145, 70, 74), rgb(122, 55, 55));
      background-size: 2000% 2000%;
      background-repeat: no-repeat;
      animation: gradient 20s ease infinite;
    }

    @keyframes gradient {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    .container {
      width: 100%;
      height: 100vh;
    }

    a {
      text-decoration: none;
    }

    li {
      list-style: none;
    }

    /* NAVBAR STYLING STARTS */
    .navbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px;
      background-color: teal;
      color: #fff;
      border-radius: 1px;
    }

    .nav-links a {
      color: #fff;
    }

    .logo {
      display: flex;
      padding: 5px;
      margin-right: 5px;
      flex-direction: row;
      justify-content: flex-start;
      align-items: center;
    }

    .logo>img {
      width: 20%;
      margin-right: 5px;
      border-radius: 5px;
    }

    .logo>p {
      font-size: 1.2em;
    }

    .menu {
      display: flex;
      gap: 1em;
      font-size: 18px;
    }

    .menu li:hover {
      background-color: #4c9e9e;
      border-radius: 5px;
      transition: 0.3s ease;
    }

    .menu li {
      padding: 5px 14px;
    }

    /* CHECKBOX HACK */
    input[type=checkbox] {
      display: none;
    }

    /*HAMBURGER MENU*/
    .hamburger {
      display: none;
      font-size: 24px;
      user-select: none;
    }


    /* STYLES FOR OTHER PAGES */
    .form-page {
      /* background-image: linear-gradient(120deg,rgba(2, 26, 27, 0.7),rgba(5, 76, 78, 0.7),rgba(2, 26, 27, 0.7)); */
      border-radius: 10px;
      width: 100%;
      /* max-width: 400px; */
      padding: 15px;
      margin: 15px auto;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      box-shadow: 0px 0px 10px rgb(3, 39, 33);
    }

    .hidden {
      display: none;
    }

    /* Manage Page Styles */
    .manage-container {
      background-image: linear-gradient(120deg, #3f0606b3, #a71111b3, #3f0606b3);
      max-width: 450px;
    }

    .main-manage-buttons {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    hr {
      margin: 10px auto 20px auto;
    }

    
    .btn {
      font-size: 1.1em;
      padding: 8px 12px;
      border-radius: 50px;
      border: none;
      margin-bottom: 10px;
    }

  
    .btn:hover {
      transition: 0.3s ease;
      background-color: black;
      color: gold;
    }

    .username,
    .password {
      padding: 10px;
      border-radius: 50px;
      border: none;
      margin-bottom: 1rem;
      outline: none;
      font-size: 1rem;
      
        }

    .stream-group {
      display: flex;
      flex-direction: column;
    }

    .stream-group>img {
      margin-bottom: 15px;
    }

    .face-buttons {
      display: flex;
      justify-content: space-around;
      margin-bottom: 10px;
    }

    .face-name {
      padding: 6px 15px;
      margin: 15px 0px;
      font-size: 1.2em;
      border-radius: 50px;
      border: none;
    }

    #face-list-container {
      color: white;
    }

    .login-group {
      margin: 1rem auto;
      width: 100%;
      max-width: 300px;
    }

    @media (max-width: 768px) {
      .menu {
        display: none;
        position: absolute;
        background-color: rgba(0, 128, 128, 0.9);
        right: 0;
        text-align: center;
        padding: 16px 0;
        height: auto;
        min-width: 300px;
        overflow: auto;
      }

      .menu li:hover {
        display: inline-block;
        background-color: #4c9e9e;
        transition: 0.3s ease;
      }

      .menu li+li {
        margin-top: 12px;
      }

      input[type=checkbox]:checked~.menu {
        transition: 0.5s ease;
        display: block;
      }

      .hamburger {
        display: block;
      }

      .landing {
        padding: 10px;
        max-width: 100vw;
        flex-direction: column;
      }

      .landing>img {
        width: 100%;
        height: auto;
      }

      .intro>p {
        margin-top: 15px;
      }

      .landing>p,
      .network-page>p {
        font-size: 1.3em;
      }

      .buttons {
        height: 25vw;
      }

      .logo>p {
        font-size: 1em;
      }

      #toggle-stream,
      #toggle-manage,
      #toggle-door {
        font-size: 1.3em;
      }
    }
  </style>
</head>

<body>
  <main class="container">
    <nav class="navbar">
      <div class="logo">
        <img
          src="data:image/png;base64,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"
          alt="face logo" />
        <p>faceApp</p>
      </div>
      <ul class="nav-links">
        <input type="checkbox" id="checkbox_toggle" />
        <label for="checkbox_toggle" class="hamburger">&#9776;</label>
        <div class="menu">
          <li><a href="/">Home</a></li>
          <li><a href="/network.html">Network</a></li>
          <li><a href="/account.html">Account</a></li>
          <li><a href="/logout.html">Logout</a></li>
        </div>
      </ul>
    </nav>

    <section class="form-page manage-container">
      <div id="face-stream-container" class="hidden">
        <div class="stream-group">
          <img src="" id="stream">
          <section id="faceID" class = hidden>
          <label for="face-name">Enter Face ID:</label>
          <input type="text" name="face-name" id="face-name" class="face-name">
          </section>
          <section id="face-buttons" class="face-buttons">
            <button id="face-detect-btn" class = "btn">Face Detect</button>
            <button id="start-enroll-btn" class = "btn">Start Enroll</button>
            <button id="face-enroll-btn" class = "btn">Enroll</button>
          </section>
        </div>
        <hr>
      </div>

      <div id="remove-face-container" class="hidden">
        <section class="stream-group">
          <label>Enter Face ID:</label>
          <input type="text" name="face-id" class="face-name" id="face-id">
          <button id="face-delete-btn">DELETE FACE</button>
          <button id="all-face-delete-btn">DELETE ALL FACES</button>

        </section>
        <hr>
      </div>

      <div id="login-detail-container" class="hidden">
        <section class="stream-group login-group">
        <input class="username" type="text" id ="USERNAME" placeholder="Enter New Username" />
        <input class="password" type="password" id = "PASSWORD" placeholder="Enter New Password" />
        <button id="submit-login-detail" class = "btn">SUBMIT</button>
      </section>
      </div>

      <div class="main-manage-buttons" id="main-manage-buttons">
        <button id="add-face" class="btn">Add Face</button>
        <button id="remove-face" class="btn">Remove Face</button>
        <button id="details-btn" class = "btn">Login Detail</button>
      </div>
      <p style="text-align: center; font-size: 1rem;
      font-family: Calibri, sans-serif; font-weight: bold; color: white;" id="status"></p>
    </section>

  </main>
  <script>
    let add_face_btn = document.getElementById("add-face");
    let remove_face_btn = document.getElementById("remove-face");
    let login_detail_btn = document.getElementById("details-btn");
    let main_manage_btn = document.getElementById("main-manage-buttons");
    let baseHost = location.origin;
    let statusInfo = document.getElementById("status")
    
    add_face_btn.addEventListener("click", () => {
      let pop_up = document.getElementById("face-stream-container");
      let stream = document.getElementById("stream");
      let streamUrl = `${baseHost}:81/stream`;
      stream.style.width = "100%";
      stream.style.borderRadius = "10px";
      stream.src = streamUrl;
      pop_up.classList.toggle("hidden");
      let detectValue = 0;

      let face_detect_btn = document.getElementById("face-detect-btn");
      face_detect_btn.addEventListener("click", () => {
        detectValue = !detectValue;
        let query = `${baseHost}/control?var=face_detect&val=${detectValue}`;
        fetch(query).then(reponse => {
          if (detectValue == true) {
            start_enroll_btn.disabled = false;
            face_detect_btn.innerHTML = "Stop Detect"
            console.log("Face detection begins");
          } else {
            console.log("Face detection ends");
            face_detect_btn.innerHTML = "Face Detect"
            face_enroll_btn.disabled = true;
          }
        });
      });

      let face_enroll_btn = document.getElementById("face-enroll-btn");
      face_enroll_btn.disabled = true;
      face_enroll_btn.addEventListener("click", () => {
        // enrollValue = !enrollValue;
        let enrollName = document.getElementById("face-name").value
        let query = `${baseHost}/control?var=face_enroll&val=${enrollName}`;
        fetch(query).then(response => {
          console.log(`Enrolling`);
        });
      });

      let start_enroll_btn = document.getElementById("start-enroll-btn")
      start_enroll_btn.disabled = true
      start_enroll_btn.addEventListener("click", () => {
        document.getElementById("faceID").classList.toggle("hidden");
        face_enroll_btn.disabled = false
      })

    });

    remove_face_btn.addEventListener("click", () => {
      let pop_up = document.getElementById("remove-face-container");
      let i = 25;
      pop_up.classList.toggle("hidden");
      let interval = setInterval(() => {
        i--;
        statusInfo.innerText = `Removing Faces in ${i} seconds`
      }, 1000);

      setTimeout(() => {
        statusInfo.innerText = "Reloading..."
        clearInterval(interval);
      }, 25000);

      setTimeout(() => {
        location.reload();
      }, 30000);

      let query = `${baseHost}/control?var=all-face-delete&val=0`;
      fetch(query).then(reponse => {
        console.log(`Faces deleted`)
      });

      let delete_face_btn = document.getElementById("face-delete-btn");
      delete_face_btn.addEventListener("click", () => {
        let face_id = document.getElementById("face-id").value;
        let query = `${baseHost}/control?var=face-delete&val=${face_id}`;
        fetch(query).then(reponse => {
          console.log(`Face ${face_id} deleted`)
        });
      });

      let all_face_delete = document.getElementById("all-face-delete-btn");
      all_face_delete.addEventListener("click", () => {
        let query = `${baseHost}/control?var=all-face-delete&val=0`;
        fetch(query).then(reponse => {
          console.log(`All faces deleted`)
        });
      });

    });

    login_detail_btn.addEventListener("click", () => {
      let pop_up = document.getElementById("login-detail-container");
      pop_up.classList.toggle("hidden");
      let submit_btn = document.getElementById("submit-login-detail")
      
      submit_btn.addEventListener("click", () => {
        let user_ = document.getElementById("USERNAME").value;
        let pass_ = document.getElementById("PASSWORD").value;
        let query = `${baseHost}/control?USERNAME=${user_}&PASSWORD=${pass_}`;
        fetch(query).then(response=>{
        console.log("Changing Username and Password");
        statusInfo.innerText = "Submit Successful"
        let i = 11;
        let interval = setInterval(()=>{
          i--;
          statusInfo.innerText = `Reloading in ${i} seconds`
            },1000);
      
      setTimeout(() => {
        statusInfo.innerText = "Reloading..."
        clearInterval(interval);
      }, 11000);

      setTimeout(() => {
        location.reload();
      }, 15000);
      })
      })

    });

  </script>
</body>

</html>